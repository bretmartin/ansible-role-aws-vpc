---

- name: configure VPC
  environment:
    AWS_PROFILE: '{{ vpc_name }}'
  ec2_vpc:

    region: '{{ region }}'
    resource_tags: { 'Name': '{{ vpc_name }}' }
    cidr_block: '{{ cidr_block }}'
    state: present

    internet_gateway: yes

  register: ec2_vpc

- name: call optional notifier
  include: roles/{{ notifier_role }}/tasks/main.yml
  vars:
     message: 'configured *VPC {{ vpc_name }}*'
  when: notifier_role is defined and
        ec2_vpc.changed
