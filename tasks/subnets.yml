---

- name: configure subnets
  environment:
    AWS_PROFILE: '{{ vpc_name }}'
  ec2_vpc_subnet:
    region: '{{ region }}'
    state: present
    vpc_id: '{{ vpc_id }}'
    az: '{{ item.az }}'
    cidr: '{{ item.cidr }}'
    resource_tags: '{{ item.resource_tags }}'
  with_items: subnets.public + subnets.private
  register: ec2_vpc_subnet

- name: call optional notifier
  include: roles/{{ notifier_role }}/tasks/main.yml
  vars:
     message: 'configured *subnets* in *VPC {{ vpc_name }}*'
  when: notifier_role is defined and
        ec2_vpc_subnet.changed
